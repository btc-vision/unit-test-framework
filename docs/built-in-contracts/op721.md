# OP721 API Reference

Complete API reference for the built-in `OP721` non-fungible token helper.

**Import:** `import { OP721 } from '@btc-vision/unit-test-framework'`
**Extends:** `ContractRuntime`

---

## Constructor

```typescript
new OP721(details: OP721Interface)
```

```typescript
interface OP721Interface extends ContractDetails {
    readonly file: string; // Path to compiled .wasm file
}
```

### Example

```typescript
const nft = new OP721({
    address: Blockchain.generateRandomAddress(),
    deployer: deployer,
    file: './bytecodes/MyNFT.wasm',
});
```

---

## Read Methods

| Method | Signature | Returns |
|--------|-----------|---------|
| `name()` | `async name(): Promise<string>` | Collection name |
| `symbol()` | `async symbol(): Promise<string>` | Collection symbol |
| `totalSupply()` | `async totalSupply(): Promise<bigint>` | Total minted tokens |
| `maxSupply()` | `async maxSupply(): Promise<bigint>` | Maximum supply |
| `balanceOf(owner)` | `async balanceOf(owner: Address): Promise<bigint>` | Token count of owner |
| `ownerOf(tokenId)` | `async ownerOf(tokenId: bigint): Promise<Address>` | Owner of token |
| `tokenURI(tokenId)` | `async tokenURI(tokenId: bigint): Promise<string>` | Token metadata URI |
| `getApproved(tokenId)` | `async getApproved(tokenId: bigint): Promise<Address>` | Approved spender |
| `isApprovedForAll(owner, operator)` | `async isApprovedForAll(owner: Address, operator: Address): Promise<boolean>` | Operator approval |
| `tokenOfOwnerByIndex(owner, index)` | `async tokenOfOwnerByIndex(owner: Address, index: bigint): Promise<bigint>` | Token ID at index |
| `getAllTokensOfOwner(owner)` | `async getAllTokensOfOwner(owner: Address): Promise<bigint[]>` | All token IDs |
| `getTransferNonce(owner)` | `async getTransferNonce(owner: Address): Promise<bigint>` | Transfer signature nonce |
| `getApproveNonce(owner)` | `async getApproveNonce(owner: Address): Promise<bigint>` | Approval signature nonce |
| `domainSeparator()` | `async domainSeparator(): Promise<Uint8Array>` | Domain separator (32 bytes) |

---

## Write Methods

### `transferFrom(from, to, tokenId, sender?)`

```typescript
async transferFrom(
    from: Address, to: Address, tokenId: bigint, sender?: Address
): Promise<CallResponse>
```

Transfers `tokenId` from `from` to `to`. The optional `sender` parameter overrides `msg.sender`.

### `safeTransferFrom(from, to, tokenId, data?, sender?)`

```typescript
async safeTransferFrom(
    from: Address, to: Address, tokenId: bigint,
    data?: Uint8Array, sender?: Address
): Promise<CallResponse>
```

Safe transfer with optional callback data.

### `approve(spender, tokenId, sender)`

```typescript
async approve(spender: Address, tokenId: bigint, sender: Address): Promise<CallResponse>
```

Approves `spender` to transfer `tokenId`.

### `setApprovalForAll(operator, approved, sender)`

```typescript
async setApprovalForAll(
    operator: Address, approved: boolean, sender: Address
): Promise<CallResponse>
```

Grants or revokes operator approval for all tokens.

### `burn(tokenId, sender)`

```typescript
async burn(tokenId: bigint, sender: Address): Promise<CallResponse>
```

Burns `tokenId`.

### `setBaseURI(baseURI)`

```typescript
async setBaseURI(baseURI: string): Promise<CallResponse>
```

Sets the base URI for token metadata.

### `transferBySignature(...)`

```typescript
async transferBySignature(
    owner: Address, to: Address, tokenId: bigint,
    deadline: bigint, signature: Uint8Array
): Promise<CallResponse>
```

### `approveBySignature(...)`

```typescript
async approveBySignature(
    owner: Address, spender: Address, tokenId: bigint,
    deadline: bigint, signature: Uint8Array
): Promise<CallResponse>
```

---

## Static Event Decoders

### `decodeTransferredEvent(data)`

```typescript
static decodeTransferredEvent(data: Buffer | Uint8Array): TransferredEventNFT

interface TransferredEventNFT {
    readonly operator: Address;
    readonly from: Address;
    readonly to: Address;
    readonly tokenId: bigint;
}
```

### `decodeApprovedEvent(data)`

```typescript
static decodeApprovedEvent(data: Buffer | Uint8Array): ApprovedEventNFT

interface ApprovedEventNFT {
    readonly owner: Address;
    readonly approved: Address;
    readonly tokenId: bigint;
}
```

### `decodeApprovedForAllEvent(data)`

```typescript
static decodeApprovedForAllEvent(data: Buffer | Uint8Array): ApprovedForAllEvent

interface ApprovedForAllEvent {
    readonly owner: Address;
    readonly operator: Address;
    readonly approved: boolean;
}
```

### `decodeURIEvent(data)`

```typescript
static decodeURIEvent(data: Buffer | Uint8Array): URIEvent

interface URIEvent {
    readonly uri: string;
    readonly tokenId: bigint;
}
```

---

[<- Previous: OP20](./op20.md) | [Next: OP721Extended ->](./op721-extended.md)
